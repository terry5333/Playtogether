<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PartyBox Admin æ•¸æ“šä¸­å¿ƒ</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body class="bg-slate-50 p-6">
    <div class="max-w-6xl mx-auto space-y-6">
        <h1 class="text-3xl font-black">ç®¡ç†å¾Œå° ğŸ“Š</h1>
        <div class="grid md:grid-cols-3 gap-6">
            <div class="md:col-span-1 space-y-4">
                <h2 class="font-bold text-slate-400 uppercase text-sm">æ´»èºæˆ¿é–“</h2>
                <div id="room-list" class="space-y-3"></div>
            </div>
            <div class="md:col-span-2 space-y-4">
                <h2 class="font-bold text-slate-400 uppercase text-sm">æ­·å²æˆ°ç¸¾ (æœ€è¿‘50ç­†)</h2>
                <div class="bg-white rounded-3xl shadow-sm border overflow-hidden">
                    <table class="w-full text-left">
                        <thead class="bg-slate-100 text-xs">
                            <tr>
                                <th class="p-4">æ™‚é–“</th>
                                <th class="p-4">éŠæˆ²</th>
                                <th class="p-4">è´å®¶</th>
                                <th class="p-4">æˆ¿è™Ÿ / è©³æƒ…</th>
                            </tr>
                        </thead>
                        <tbody id="history-body" class="text-sm divide-y"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    <script>
        const socket = io();
        socket.on('connect', () => socket.emit('admin_init'));
        socket.on('admin_data_update', (data) => {
            document.getElementById('room-list').innerHTML = data.rooms.map(r => `
                <div class="bg-white p-4 rounded-2xl shadow-sm border border-blue-100">
                    <div class="flex justify-between font-black text-blue-500 mb-1"><span>æˆ¿è™Ÿ ${r.id}</span><span class="text-xs bg-blue-50 px-2 rounded">${r.game}</span></div>
                    <div class="text-[10px] text-slate-400 mb-2">æˆ¿ä¸»: ${r.host}</div>
                    <div class="flex flex-wrap gap-1">${r.players.map(p => `<span class="bg-slate-100 px-2 py-0.5 rounded text-[10px]">${p.name}</span>`).join('')}</div>
                </div>
            `).join('');
            document.getElementById('history-body').innerHTML = data.history.map(h => `
                <tr class="hover:bg-slate-50">
                    <td class="p-4 text-slate-400 font-mono text-xs">${h.time}</td>
                    <td class="p-4 font-bold text-slate-700">${h.gameType}</td>
                    <td class="p-4 font-black text-blue-600">ğŸ‘‘ ${h.winner}</td>
                    <td class="p-4 text-slate-400 text-xs">${h.detail} (Room:${h.roomId})</td>
                </tr>
            `).join('');
        });
    </script>
</body>
</html>
