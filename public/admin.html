<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>PartyBox Admin</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body class="bg-gray-100 p-8">
    <h1 class="text-3xl font-black mb-6 text-gray-800">後台數據監控</h1>
    <div id="room-list" class="grid gap-4"></div>

    <script>
        const socket = io();
        
        // 一連線就告訴後端：我是 Admin，給我數據
        socket.on('connect', () => {
            console.log("Admin Connected");
            socket.emit('admin_init');
        });

        socket.on('admin_data_update', (rooms) => {
            console.log("Received Data:", rooms);
            const list = document.getElementById('room-list');
            if(rooms.length === 0) {
                list.innerHTML = `<p class="text-gray-400">目前沒有運作中的房間</p>`;
                return;
            }
            list.innerHTML = rooms.map(r => `
                <div class="bg-white p-6 rounded-3xl shadow-sm border border-gray-200">
                    <div class="flex justify-between font-bold text-lg mb-2">
                        <span>房號: ${r.id}</span>
                        <span class="text-blue-500">${r.game}</span>
                    </div>
                    <div class="text-sm text-gray-500 mb-4">房主: ${r.host}</div>
                    <div class="flex flex-wrap gap-2">
                        ${r.players.map(p => `
                            <span class="px-3 py-1 bg-gray-100 rounded-full text-xs font-bold">${p.name}</span>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        });
    </script>
</body>
</html>
