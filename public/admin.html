<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Admin Panel</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
</head>
<body class="bg-gray-950 text-slate-200 p-8">
    <div class="max-w-7xl mx-auto grid lg:grid-cols-2 gap-8">
        <div class="bg-gray-900 p-6 rounded-3xl border border-gray-800">
            <h2 class="text-xl font-bold mb-4">ğŸ† ç©å®¶æ¸…å–®èˆ‡æˆ°ç¸¾</h2>
            <div id="user-list" class="space-y-2"></div>
        </div>
        <div class="bg-gray-900 p-6 rounded-3xl border border-gray-800">
            <h2 class="text-xl font-bold mb-4">ğŸ® å³æ™‚æˆ¿é–“ç›£æ§</h2>
            <div id="room-monitor" class="space-y-4"></div>
        </div>
    </div>

    <script>
        const socket = io();
        socket.emit('admin_init');

        socket.on('admin_full_update', data => {
            document.getElementById('user-list').innerHTML = data.users.map(u => `
                <div class="flex justify-between items-center bg-gray-800 p-3 rounded-xl">
                    <span>${u.avatar} <b>${u.username}</b> (${u.pin})</span>
                    <div class="flex items-center gap-4">
                        <span class="text-indigo-400 font-bold">${u.score} PT</span>
                        <button onclick="socket.emit('admin_delete_user','${u._id}')" class="text-red-500 text-xs">åˆªé™¤</button>
                    </div>
                </div>
            `).join('');

            const rm = document.getElementById('room-monitor');
            if(data.rooms.length === 0) { rm.innerHTML = "ç›®å‰ç„¡æˆ¿é–“"; return; }
            rm.innerHTML = data.rooms.map(r => `
                <div class="bg-gray-800 p-4 rounded-2xl border border-gray-700">
                    <div class="flex justify-between mb-3">
                        <span class="bg-indigo-600 px-2 rounded">#${r.id}</span>
                        <button onclick="socket.emit('admin_close_room','${r.id}')" class="text-red-400 text-xs">é—œé–‰æˆ¿é–“</button>
                    </div>
                    <div class="grid grid-cols-2 gap-2">
                        ${r.players.map(p => `
                            <div class="text-xs bg-gray-900 p-2 rounded flex justify-between">
                                <span>${p.avatar} ${p.username}</span>
                                <button onclick="socket.emit('admin_kick_player',{roomId:'${r.id}',socketId:'${p.socketId}'})" class="text-orange-500">è¸¢å‡º</button>
                            </div>
                        `).join('')}
                    </div>
                </div>
            `).join('');
        });
    </script>
</body>
</html>
